<!DOCTYPE html>
<!-- Created By CodingNepal -->
<html lang="en" dir="ltr">
   <html lang="en" dir="ltr">
      <head>
         <meta charset="utf-8">
         <title>Circular Progress Bar | CodingNepal</title>
         <link rel="stylesheet" href="./css/resultModal.css">
      </head>
      <body>
            
        <script>
            // 사이즈, 인덱스 및 className, 바 사이즈, 바 색깔, 백그라운드 색깔
            var RadialProgress = function(size, zIndex, barSize, barColor, backgroundColor) { // jshint ignore:line
                    this.radialProgress = document.createElement('div');
                    this.style = document.createElement('style');
                    this.progress = 0;
                    var requestAnimationFrame = window.requestAnimationFrame ||
                        window.mozRequestAnimationFrame ||
                        window.webkitRequestAnimationFrame ||
                        window.oRequestAnimationFrame ||
                        window.msRequestAnimationFrame;

                    barSize = (barSize % 2 === 1) ? (barSize + 1) : barSize;
                    var innerSize = size - barSize;
                    var innerMargin = barSize / 2;

                    this.radialProgress.className = 'radial-progress' + zIndex;
                    this.radialProgress.innerHTML = '<div class="inner-circle' + zIndex+ '"">' +
                        '</div>' +
                        '<div class="outer-circle' + zIndex + '">' +
                        '<div class="mask' + zIndex + ' full' + zIndex + '">' +
                        '<div class="fill' + zIndex + '"></div>' +
                        '</div>' +
                        '<div class="mask' + zIndex + '">' +
                        '<div class="fill' + zIndex + '"></div>' +
                        '<div class="fill' + zIndex + ' fix' + zIndex + '"></div>' +
                        '</div>' +
                        '</div>';

                    this.style.type = 'text/css';
                    this.style.innerHTML = '.radial-progress' + zIndex + ' {' +
                        'width:' + size + 'px;' +
                        'height: ' + size + 'px;' +
                        'position: absolute;' +
                        'margin: auto;' +
                        'top: 0; right: 0; bottom: 0; left: 0;' +
                        'z-index: ' + zIndex + ';' +
                        'background-color: #DDD;' +
                        'border-radius: 50%;' +
                        'box-shadow: 0px 2px 10px rgba(0, 0, 0, 0.2);' +
                        '}' +
                        '.radial-progress' + zIndex + ' .inner-circle' + zIndex + ' {' +
                        'width: ' + innerSize + 'px;' +
                        'height: ' + innerSize + 'px;' +
                        'position: absolute;' +
                        'margin-top: ' + innerMargin + 'px;' +
                        'margin-left: ' + innerMargin + 'px;' +
                        'background-color: ' + backgroundColor + ';' +
                        'border-radius: 50%;' +
                        'z-index: 10;' +
                        '}' +
                        '.radial-progress' + zIndex + ' .outer-circle' + zIndex + ' .mask' + zIndex + ',' +
                        '.radial-progress' + zIndex + ' .outer-circle' + zIndex + ' .fill' + zIndex + ' {' +
                        'width: ' + size + 'px;' +
                        'height: ' + size + 'px;' +
                        'position: absolute;' +
                        'border-radius: 50%;' +
                        '-webkit-backface-visibility: hidden;' +
                        '}' +
                        '.radial-progress' + zIndex + ' .outer-circle' + zIndex + ' .mask' + zIndex + ' {' +
                        'clip: rect(0px, ' + size + 'px, ' + size + 'px, ' + size / 2 + 'px);' +
                        '}' +
                        '.radial-progress' + zIndex + ' .outer-circle' + zIndex + ' .mask' + zIndex + ' .fill' + zIndex + ' {' +
                        'clip: rect(0px, ' + size / 2 + 'px, ' + size + 'px, 0px);' +
                        'background-color: ' + barColor + ';' +
                        '}';

                    document.getElementsByTagName('head')[0].appendChild(this.style);
                    document.body.appendChild(this.radialProgress);

                    this.remove = function() {
                        var self = this;
                        var scale = 1;
                        var deltaScale = 0.1 / 10;

                        function step() {
                            scale += deltaScale;
                            scale = (scale < 0) ? 0 : scale;
                            self.radialProgress.style.transform = 'scale(' + scale + ')';

                            if (scale > 1.1) {
                                deltaScale = -1.1 / 8;
                            }

                            if (scale > 0) {
                                requestAnimationFrame(step);
                            } else {
                                document.getElementsByTagName('head')[0].removeChild(self.style);
                                document.body.removeChild(self.radialProgress);
                            }
                        }

                        requestAnimationFrame(step);
                    };

                    this.setProgress = function(progress, duration, zIndex) {
                        progress = (progress > 100) ? 100 : progress;
                        var self = this;
                        var $maskFull = this.radialProgress.getElementsByClassName('mask' + zIndex + ' full' + zIndex)[0];
                        var $fill = this.radialProgress.getElementsByClassName('fill' + zIndex);
                        var $fillFix = this.radialProgress.getElementsByClassName('fill' + zIndex + ' fix' + zIndex)[0];
                        var deltaProgress = (progress - this.progress) / (duration * 60);

                        function step() {
                        self.progress += deltaProgress;
                        self.progress = (self.progress > progress) ? progress : self.progress;
                        var rotate = self.progress * 1.8;
                        $maskFull.style.transform = 'rotate(' + rotate + 'deg)';

                        for (var i = 0; i < $fill.length; ++i) {
                            $fill[i].style.transform = 'rotate(' + rotate + 'deg)';
                        }

                        $fillFix.style.transform = 'rotate(' + 2 * rotate + 'deg)';

                        if (self.progress < progress) {
                            requestAnimationFrame(step);
                        }

                        if (self.progress === 100) {
                            setTimeout(function() {
                                // self.remove();   // 종료
                            }, 1000);
                        }
                        }

                        requestAnimationFrame(step);
                    };  
                };

                function createProgress() {
                    var progress = new RadialProgress(300, '10', 8, '#EB6540', '#FFF', '#000' );
                    var progress2 = new RadialProgress(250, '15', 8, '#48A7BD', '#FFF', '#000');
                    var progress3 = new RadialProgress(200, '20', 8, '#A66EF5', '#FFF', '#000');

                    setTimeout(function() {
                        progress.setProgress(60, 0.5, "10");
                        progress2.setProgress(80, 0.5, "15");
                        progress3.setProgress(90, 0.5, "20");
                    }, 1000);
                }

                createProgress();



        </script>
    </body>
</html>